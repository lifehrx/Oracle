### 分别查出100% 20% 10% 5% 的数量并分组统计

```SQL
select sum(case when (CASE WELD.WELDS_TYPE WHEN 1 THEN ES.BUTT_JOINT_DEC_RATIO
						WHEN 2 THEN ES.ANGLE_JOINT_DEC_RATIO
						WHEN 3 THEN ES.OFFTAKE_DEC_RATIO
						ELSE '--' END) = '100%' then 1 else 0 end) oneHundred,
       sum(case when (CASE WELD.WELDS_TYPE WHEN 1 THEN ES.BUTT_JOINT_DEC_RATIO
						WHEN 2 THEN ES.ANGLE_JOINT_DEC_RATIO
						WHEN 3 THEN ES.OFFTAKE_DEC_RATIO
						ELSE '--' END) = '20%' then 1 else 0 end) twenty,
       sum(case when (CASE WELD.WELDS_TYPE WHEN 1 THEN ES.BUTT_JOINT_DEC_RATIO
						WHEN 2 THEN ES.ANGLE_JOINT_DEC_RATIO
						WHEN 3 THEN ES.OFFTAKE_DEC_RATIO
						ELSE '--' END) = '10%' then 1 else 0 end) ten,
       sum(case when (CASE WELD.WELDS_TYPE WHEN 1 THEN ES.BUTT_JOINT_DEC_RATIO
						WHEN 2 THEN ES.ANGLE_JOINT_DEC_RATIO
						WHEN 3 THEN ES.OFFTAKE_DEC_RATIO
						ELSE '--' END) = '5%' then 1 else 0 end) five

FROM TB_CM_WELDING_PROCESS WP
			LEFT JOIN TB_CM_PIPELINE PIPELINE ON PIPELINE_ID = PIPELINE.ID
			LEFT JOIN TB_CM_WELD WELD ON WP.WELD_ID = WELD.ID
			LEFT JOIN TB_CM_DETECTION_CLASS DC ON DC.ID=WELD.DETECT_CLASS_ID
			LEFT JOIN TB_CM_EXECUTIVE_STANDARD ES ON WELD.PIPELINE_LEVEL=ES.PIPE_LEVEL AND DC.EXECUTIVE_STANDARD=ES.EXECUTIVE_STANDARD AND ES.DEVICE_ID  = PIPELINE.DEVICE_ID
			LEFT JOIN TB_CM_LABEL LABEL ON LABEL.WELD_ID=WP.WELD_ID
			WHERE WELD.NOMINAL_DIAMETER < 500
			[AND PIPELINE.device_id={:deviceId:}]
			AND (LABEL.WELD_ID IS NULL OR LABEL.LABEL_TYPE!=1)
			AND WELD.IS_CANCEL = 0
			AND WELD.IS_CUT_WELD = 0
			AND WELD.IS_AVAILABLE = '1'
			AND WP.BATCH_ID IS NULL
			AND WP.IS_AVAILABLE = '1'
			AND PIPELINE.IS_AVAILABLE = '1'
			AND ES.IS_AVAILABLE = '1'
			AND WP.REPAIR_IDENTIFY=0
			AND (CASE WELD.WELDS_TYPE WHEN 1 THEN ES.BUTT_JOINT_DEC_RATIO
						WHEN 2 THEN ES.ANGLE_JOINT_DEC_RATIO
						WHEN 3 THEN ES.OFFTAKE_DEC_RATIO
						ELSE '--' END)!='--'
            AND (CASE WELD.WELDS_TYPE WHEN 1 THEN ES.BUTT_JOINT_DEC_RATIO
                        WHEN 2 THEN ES.ANGLE_JOINT_DEC_RATIO
                        WHEN 3 THEN ES.OFFTAKE_DEC_RATIO
                        ELSE '--' END)!='0%'
```            
